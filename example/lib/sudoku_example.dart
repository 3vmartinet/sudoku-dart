import 'package:sudoku_dart/sudoku_dart.dart';
import 'package:test/test.dart';

List<List<int>> puzzles(){
  return [
    // easy
		[-1, -1, 5, 4, -1, 7, 3, -1, 1, 4, -1, 7, 3, 1, -1, 6, -1, -1, -1, 8, 1, 2, 6, -1, -1, 9, -1, 5, -1, -1, -1, 3, 9, -1, -1, -1, -1, 2, 6, 7, -1, 4, -1, -1, -1, 7, -1, 3, 5, -1, -1, 9, -1, -1, 6, -1, 2, -1, -1, -1, 8, -1, 9, -1, 3, -1, -1, 7, 2, 4, 5, -1, 8, 7, 4, -1, -1, -1, 1, 3, 2],
		[-1, 1, -1, 8, -1, -1, -1, -1, 3, -1, 7, -1, -1, 9, 3, -1, -1, -1, 2, 9, -1, -1, 5, -1, -1, -1, -1, 1, -1, -1, -1, -1, 9, 3, 5, -1, 5, -1, 4, 7, 1, -1, -1, 9, 2, 9, -1, 2, 5, 3, -1, 1, -1, 8, 7, -1, -1, 6, 8, -1, -1, -1, -1, 6, 2, 9, 3, 4, -1, 5, 8, -1, 3, -1, 8, -1, 2, -1, 7, 4, 6],
		// expert
		[-1, 7, -1, -1, 2, 6, 1, -1, -1, -1, -1, -1, 9, -1, -1, -1, -1, -1, -1, -1, 8, 7, -1, -1, -1, -1, -1, -1, 9, -1, 4, 8, -1, -1, -1, -1, 1, 2, -1, -1, -1, 7, -1, 3, -1, -1, -1, -1, 3, -1, 2, 4, -1, -1, -1, 3, 9, 2, 5, -1, -1, 8, -1, 4, -1, -1, -1, 6, -1, -1, 7, -1, 6, 5, -1, -1, -1, -1, -1, -1, -1],
		[-1, -1, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, 6, 5, 2, -1, -1, -1, 1, -1, 2, -1, -1, -1, 3, -1, -1, 9, -1, -1, -1, -1, -1, 7, 4, 5, 4, -1, -1, -1, -1, 5, 8, -1, -1, -1, 2, -1, 7, -1, 3, -1, -1, 9, -1, -1, -1, 1, -1, -1, -1, -1, 8, -1, -1, 3, 2, -1, -1, 9, -1, -1, -1, 8, 9, -1, -1, 7, 1, -1, -1],
		[-1, -1, 1, -1, 8, 9, -1, -1, -1, 2, 8, -1, -1, -1, 7, -1, -1, 1, -1, 7, -1, 3, -1, 1, -1, 9, -1, 5, -1, -1, -1, 9, -1, 6, 1, 7, -1, -1, -1, -1, -1, -1, -1, 3, -1, -1, 6, 7, 5, -1, -1, -1, -1, -1, -1, 1, -1, -1, -1, -1, -1, -1, 4, -1, 2, -1, 7, -1, -1, -1, -1, 5, -1, -1, -1, -1, 6, -1, 9, -1, -1],
		// hell
		[-1, -1, 1, -1, -1, -1, 4, 2, -1, -1, -1, 7, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 8, -1, -1, -1, -1, 5, -1, -1, 4, -1, 9, -1, -1, -1, -1, -1, -1, -1, 5, -1, -1, 8, 3, -1, 9, -1, -1, -1, -1, -1, 7, -1, 7, -1, -1, -1, 3, -1, 2, -1, 5, -1, 3, -1, -1, 9, 8, -1, -1, -1, -1, -1, -1, -1, -1, -1, 1, -1, -1],
		[-1, -1, -1, 8, 5, -1, 7, -1, -1, -1, -1, 4, -1, 3, -1, -1, -1, -1, -1, 2, 3, -1, -1, -1, -1, -1, 4, 1, -1, -1, -1, -1, -1, -1, -1, -1, 9, -1, -1, -1, 1, 7, -1, -1, -1, -1, -1, -1, 4, -1, -1, -1, -1, 6, -1, 1, -1, -1, -1, -1, -1, 7, -1, -1, -1, -1, 3, 9, -1, 1, 8, -1, -1, -1, -1, 5, -1, -1, -1, -1, -1],
		[-1, -1, -1, -1, -1, -1, 7, -1, -1, -1, -1, 4, -1, 3, -1, -1, -1, -1, -1, 2, 3, -1, -1, -1, -1, -1, 4, 1, -1, -1, -1, -1, -1, -1, -1, -1, 9, -1, -1, -1, 1, 7, -1, -1, -1, -1, -1, -1, 4, -1, -1, -1, -1, 6, -1, 1, -1, -1, -1, -1, -1, 7, -1, -1, -1, -1, 3, 9, -1, 1, 8, -1, -1, -1, -1, 5, -1, -1, -1, -1, -1],
		[-1, -1, -1, 2, 6, 5, 1, -1, -1, -1, 6, -1, -1, -1, -1, -1, 7, 4, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 3, -1, 5, -1, 9, -1, -1, 8, -1, 4, -1, 6, -1, -1, 9, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 7, 4, -1, -1, -1, -1, -1, 5, 1, -1, -1, -1, -1, -1, 8, -1, 3, -1, -1, -1, -1, -1, -1, -1, 7],
  ];
}

void main() {

  test('test solve puzzle',() {
    // resolve sudoku puzzle
    // List<int> puzzle = [
    //   -1,-1,8,    9,-1,6,     -1,-1,5,
    //   -1,4,3,     -1,-1,-1,   -1,2,-1,
    //   -1,-1,-1,   -1,-1,-1,   -1,-1,-1,
    //
    //   -1,-1,4,    -1,-1,-1,   9,-1,-1,
    //   5,-1,-1,    -1,4,-1,    6,8,-1,
    //   -1,-1,-1,   1,-1,-1,    -1,-1,-1,
    //
    //   2,-1,-1,    -1,8,-1,    -1,7,-1,
    //   -1,-1,-1,   -1,3,4,     1,-1,-1,
    //   -1,6,-1,    -1,-1,9,    -1,-1,-1,
    // ];

    // List<int> puzzle = [
    //   -1, -1, -1, 3, 1, 2, -1, -1, -1, -1, -1, -1, 6, 8, 9, -1, -1, -1, -1, -1, -1, 4, 7, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1
    // ];

    // 唯一解数独
    List<int> puzzle = [
      -1,3,-1,-1,9,-1,-1,-1,7,8,9,-1,-1,-1,-1,-1,1,-1,-1,-1,2,-1,-1,-1,4,-1,-1,-1,4,8,-1,-1,6,-1,-1,-1,-1,-1,-1,-1,-1,8,-1,-1,9,-1,2,-1,-1,7,-1,-1,-1,-1,6,-1,-1,-1,3,9,1,5,-1,-1,-1,-1,2,-1,5,-1,6,-1,-1,5,9,-1,1,-1,-1,8,-1
    ];
    Sudoku sudoku = Sudoku(puzzle, strict: true);
    sudoku.debug();
    
    expectLater(sudoku.puzzle,puzzle);
    expectLater(sudoku.solution.any((element) => element == -1), false);

    int batchSolvePuzzlesTotalTime = 0;
    print("-- batch solve puzzles --");
    for(puzzle in puzzles()){
      sudoku = Sudoku(puzzle);
      expectLater(sudoku.puzzle,puzzle);
      expectLater(sudoku.solution.any((element) => element == -1), false);
      batchSolvePuzzlesTotalTime+=sudoku.timeCount;
      print("solve single puzzle with time : ${sudoku.timeCount}'ms");
      print("----");
    }
    print("-- batch solve puzzles done--");
    print("-- batch solve puzzles total time : ${batchSolvePuzzlesTotalTime}'ms");

  });

  test('test generator',() {
    // sudo generator with expert level
    int beginTime = DateTime.now().millisecondsSinceEpoch;
    Sudoku sudoku = Sudoku.generate(Level.expert);
    int endTime = DateTime.now().millisecondsSinceEpoch;
    sudoku.debug();
    expect(sudoku.solution.any((element) => element == -1), false);
    String str = sudoku.puzzle.join(",");
    print('this is puzzle can be copy to the clipboard : ');
    print(str);
    print('generated total time : ${endTime - beginTime}\'ms');


  });
}
